{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/napak/embed/project/embeddedproj/src/app/components/icons/MicIcon.tsx"],"sourcesContent":["export const MicIcon = ()=>{\r\n    return (\r\n        <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"currentColor\" className=\"size-6\">\r\n            <path d=\"M8.25 4.5a3.75 3.75 0 1 1 7.5 0v8.25a3.75 3.75 0 1 1-7.5 0V4.5Z\" />\r\n            <path d=\"M6 10.5a.75.75 0 0 1 .75.75v1.5a5.25 5.25 0 1 0 10.5 0v-1.5a.75.75 0 0 1 1.5 0v1.5a6.751 6.751 0 0 1-6 6.709v2.291h3a.75.75 0 0 1 0 1.5h-7.5a.75.75 0 0 1 0-1.5h3v-2.291a6.751 6.751 0 0 1-6-6.709v-1.5A.75.75 0 0 1 6 10.5Z\" />\r\n        </svg>\r\n    )\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAO,MAAM,UAAU;IACnB,qBACI,kRAAC;QAAI,OAAM;QAA6B,SAAQ;QAAY,MAAK;QAAe,WAAU;;0BACtF,kRAAC;gBAAK,GAAE;;;;;;0BACR,kRAAC;gBAAK,GAAE;;;;;;;;;;;;AAGpB"}},
    {"offset": {"line": 174, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/napak/embed/project/embeddedproj/src/app/api/google.js"],"sourcesContent":["const { google } = require('googleapis');\r\nconst FormData = require('form-data');\r\nconst axios = require('axios');\r\n\r\nexport async function uploadFormDataToDrive(formData, accessToken) {\r\n  try {\r\n    // If you have the file as Buffer from FormData\r\n    const fileBuffer = formData; // Assuming you extract the file buffer\r\n    \r\n    const auth = new google.auth.OAuth2();\r\n    auth.setCredentials({ access_token: accessToken });\r\n\r\n    const drive = google.drive({ version: 'v3', auth });\r\n\r\n    const response = await drive.files.create({\r\n      requestBody: {\r\n        name: `audio-${Date.now()}.webm`,\r\n        mimeType: 'audio/webm',\r\n        parents: ['root'] // Optional: specify folder ID\r\n      },\r\n      media: {\r\n        mimeType: 'audio/webm',\r\n        body: fileBuffer\r\n      },\r\n      fields: 'id, name, webViewLink, webContentLink'\r\n    });\r\n\r\n    return {\r\n      success: true,\r\n      fileId: response.data.id,\r\n      fileName: response.data.name,\r\n      viewLink: response.data.webViewLink,\r\n      downloadLink: response.data.webContentLink\r\n    };\r\n  } catch (error) {\r\n    console.error('Google Drive upload error:', error);\r\n    throw error;\r\n  }\r\n}"],"names":[],"mappings":";;;;AAAA,MAAM,EAAE,MAAM,EAAE;AAChB,MAAM;AACN,MAAM;AAEC,eAAe,sBAAsB,QAAQ,EAAE,WAAW;IAC/D,IAAI;QACF,+CAA+C;QAC/C,MAAM,aAAa,UAAU,uCAAuC;QAEpE,MAAM,OAAO,IAAI,OAAO,IAAI,CAAC,MAAM;QACnC,KAAK,cAAc,CAAC;YAAE,cAAc;QAAY;QAEhD,MAAM,QAAQ,OAAO,KAAK,CAAC;YAAE,SAAS;YAAM;QAAK;QAEjD,MAAM,WAAW,MAAM,MAAM,KAAK,CAAC,MAAM,CAAC;YACxC,aAAa;gBACX,MAAM,CAAC,MAAM,EAAE,KAAK,GAAG,GAAG,KAAK,CAAC;gBAChC,UAAU;gBACV,SAAS;oBAAC;iBAAO,CAAC,8BAA8B;YAClD;YACA,OAAO;gBACL,UAAU;gBACV,MAAM;YACR;YACA,QAAQ;QACV;QAEA,OAAO;YACL,SAAS;YACT,QAAQ,SAAS,IAAI,CAAC,EAAE;YACxB,UAAU,SAAS,IAAI,CAAC,IAAI;YAC5B,UAAU,SAAS,IAAI,CAAC,WAAW;YACnC,cAAc,SAAS,IAAI,CAAC,cAAc;QAC5C;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,8BAA8B;QAC5C,MAAM;IACR;AACF"}},
    {"offset": {"line": 223, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/napak/embed/project/embeddedproj/src/app/components/Mic.tsx"],"sourcesContent":["'use client'\r\nimport { MicIcon } from \"./icons/MicIcon\";\r\nimport { useState, useEffect, useRef } from \"react\";\r\nimport { uploadFormDataToDrive } from \"../api/google\";\r\nexport const Mic = () => {\r\n    const [canRecord, setCanRecord] = useState(true);\r\n    const [isRecording, setIsRecording] = useState(false);\r\n    const [audioUrl, setAudioUrl] = useState<string | null>(null);\r\n\r\n    const streamRef = useRef<MediaStream | null>(null);\r\n    const recorderRef = useRef<MediaRecorder | null>(null);\r\n    const chunksRef = useRef<Blob[]>([]);\r\n    const sendGoogleDriveApi = async (audioBlob: Blob) => {\r\n        const formData = new FormData();\r\n        formData.append('file', audioBlob, 'recording.webm');\r\n        console.log('Uploading to Google Drive...');\r\n        uploadFormDataToDrive(formData);\r\n    }\r\n    // Request microphone access and prepare MediaRecorder\r\n    useEffect(() => {\r\n        let mounted = true;\r\n        async function init() {\r\n            if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {\r\n                setCanRecord(false);\r\n                return;\r\n            }\r\n\r\n            try {\r\n                const stream = await navigator.mediaDevices.getUserMedia({ audio: true });\r\n                if (!mounted) return;\r\n                streamRef.current = stream;\r\n\r\n                const recorder = new MediaRecorder(stream);\r\n                recorder.ondataavailable = (e: BlobEvent) => {\r\n                    if (e.data && e.data.size > 0) {\r\n                        chunksRef.current.push(e.data);\r\n                    }\r\n                };\r\n\r\n                recorder.onstop = () => {\r\n                    const audioBlob = new Blob(chunksRef.current, { type: \"audio/webm\" });\r\n                    chunksRef.current = [];\r\n                    const url = URL.createObjectURL(audioBlob);\r\n                    setAudioUrl(url);\r\n                    sendGoogleDriveApi(audioBlob);\r\n\r\n                };\r\n\r\n                recorderRef.current = recorder;\r\n                \r\n                setCanRecord(true);\r\n            } catch (err) {\r\n                console.error(\"Error accessing microphone:\", err);\r\n                setCanRecord(false);\r\n            }\r\n        }\r\n\r\n        init();\r\n\r\n        return () => {\r\n            mounted = false;\r\n            // cleanup: stop recorder and tracks\r\n            if (recorderRef.current && recorderRef.current.state !== \"inactive\") {\r\n                try {\r\n                    recorderRef.current.stop();\r\n                } catch {}\r\n            }\r\n            if (streamRef.current) {\r\n                streamRef.current.getTracks().forEach((t) => t.stop());\r\n                streamRef.current = null;\r\n            }\r\n            if (audioUrl) {\r\n                URL.revokeObjectURL(audioUrl);\r\n            }\r\n        };\r\n    }, []);\r\n\r\n    const handleClick = () => {\r\n        if (!canRecord) return;\r\n\r\n        const recorder = recorderRef.current;\r\n        if (!recorder) return;\r\n        if (!isRecording) {\r\n            // start recording\r\n            chunksRef.current = [];\r\n            try {\r\n                recorder.start();\r\n                setIsRecording(true);\r\n            } catch (err) {\r\n                console.error(\"Failed to start recorder\", err);\r\n            }\r\n        } else {\r\n            // stop recording\r\n            try {\r\n                recorder.stop();\r\n            } catch (err) {\r\n                console.error(\"Failed to stop recorder\", err);\r\n            }\r\n            setIsRecording(false);\r\n            \r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"flex flex-col items-center justify-center gap-1\">\r\n            <button\r\n                className={`bg-primary-200 h-[70px] w-[70px] relative text-primary-800 py-2 px-2 rounded-full shadow-lg hover:shadow-xl transition duration-300 ease-in-out flex items-center justify-center\r\n                        ${isRecording ? \"animate-bounce\" : \"\"}`}\r\n                onClick={handleClick}\r\n            >\r\n                <div className=\"flex items-center absolute justify-center\">\r\n                    <MicIcon />\r\n                </div>\r\n            </button>\r\n\r\n            {isRecording ? (\r\n                <div className=\"text-sm text-primary-200\">Listening...</div>\r\n            ) : (\r\n                <div className=\"text-sm text-primary-200\">Tap to speak</div>\r\n            )}\r\n\r\n            {audioUrl && (\r\n                <audio className=\"mt-2\" controls src={audioUrl} />\r\n            )}\r\n        </div>\r\n    );\r\n};"],"names":[],"mappings":"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"}}]
}